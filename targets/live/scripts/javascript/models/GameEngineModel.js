(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["backbone","BoardView","SpaceShipView","PlanetView","StarView","constants","lodash","raphael"],function(e,n,r,i,s,o,u,a){var f;return f=function(e){function u(){return u.__super__.constructor.apply(this,arguments)}return t(u,e),u.prototype.starInterval=10,u.prototype.enemyInterval=60,u.prototype.initialize=function(){return this.$window=$(window),this.winHeight=this.$window.height(),this.winWidth=this.$window.width(),this.$score=$("#score"),this.age=0,this.starTicker=0,this.enemyTicker=0,this.planets=0,this.planetViews=[]},u.prototype.makeBoard=function(){return this.mBoardView=new n(this.winWidth,this.winHeight)},u.prototype.makeSpaceship=function(){var e;return e={x:this.winWidth/2,y:this.winHeight-250},this.mSpaceshipView=new r(this.mBoardView.paper(),this.$window,this.winWidth,e)},u.prototype.startTime=function(){var e=this;return this.ticker=setInterval(function(){return e.enemyTicker===e.enemyInterval&&(e.enemyTicker=0,--e.enemyInterval,e.createEnemy()),e.starTicker===e.starInterval&&(e.starTicker=0,e.createStar()),e.checkForCollisions(),++e.age,++e.starTicker,++e.enemyTicker},o.TICK)},u.prototype.createEnemy=function(){return--this.easiness,++this.planets,this.showScore(),this.planetViews.push(new i(this.mBoardView.paper(),this.$window,this.winWidth,this.winHeight))},u.prototype.createStar=function(){return new s(this.mBoardView.paper(),this.winWidth,this.winHeight)},u.prototype.showScore=function(){return this.$score.html("SCORE: "+this.planets)},u.prototype.checkForCollisions=function(){var e,t,n,r,i;r=this.planetViews,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.checkCollision(e));return i},u.prototype.checkCollision=function(e){var t,n,r,i,s;t=e.getBBox(),n=this.mSpaceshipView.getBBox();if(t!=null&&n!=null&&a.isBBoxIntersect(e.getBBox(),this.mSpaceshipView.getBBox())){clearInterval(this.ticker),s=this.planetViews;for(r=0,i=s.length;r<i;r++)e=s[r],e.stop();return alert("Game Over")}},u}(e.Model)})}).call(this)