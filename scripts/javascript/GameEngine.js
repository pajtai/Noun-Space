(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define(["lodash","jaws","Ship","Planet","Star"],function(t,n,r,i,s){var o;return o=function(){function o(){this.checkForCollisions=e(this.checkForCollisions,this),this.isOutside=e(this.isOutside,this)}return o.prototype.setup=function(){return n.preventDefaultKeys(["left","right","up","down","space"]),this.difficulty=0,this.levelUp=0,this.score=0,this.howManyPlanets=0,this.scoreView=document.getElementById("score"),this.viewport=new n.Viewport({max_x:n.width,max_y:n.height}),this.ship=new r({x:n.width/2,y:n.height-225}),this.planets=new n.SpriteList,this.stars=new n.SpriteList},o.prototype.update=function(){var e;return e=t.random(0,100),this.handlePlayerInput(),this.createEnemies(e),this.createStars(e),this.moveThings(),this.checkForCollisions()},o.prototype.draw=function(){return n.context.clearRect(0,0,n.width,n.height),this.ship.draw(),this.planets.draw(),this.stars.draw()},o.prototype.handlePlayerInput=function(){n.pressed("left")&&this.ship.moveLeft();if(n.pressed("right"))return this.ship.moveRight()},o.prototype.createEnemies=function(e){var t;if(0<=e&&e<=this.difficulty)return++this.levelUp,++this.howManyPlanets,this.levelUp===5&&(this.levelUp=0,++this.difficulty),t=new i(this.viewport),this.viewport.forceInsideVisibleArea(t,1),this.planets.push(t),this.scoreView.innerHTML=this.howManyPlanets*(this.difficulty+1)},o.prototype.createStars=function(e){var t;if(75<e&&e<100)return t=new s(this.viewport),this.viewport.forceInsideVisibleArea(t,1),this.stars.push(t)},o.prototype.moveThings=function(){return this.planets.forEach(function(e){return e.moveDown()}),this.planets.removeIf(this.isOutside),this.stars.forEach(function(e){return e.moveDown()}),this.stars.removeIf(this.isOutside)},o.prototype.isOutside=function(e){return this.viewport.isOutside(e)},o.prototype.checkForCollisions=function(){var e=this;return n.collideOneWithMany(this.ship,this.planets).forEach(function(t){return t.stop(),e.ship.stop(),n.switchGameState({setup:n.context.clearRect(0,0,n.width,n.height)}),alert("GameOver")})},o}()})}).call(this)